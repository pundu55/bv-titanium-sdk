/**
 * almond 0.1.1 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
 Lo-Dash 0.4.2 lodash.com/license
 Underscore.js 1.3.3 github.com/documentcloud/underscore/blob/master/LICENSE
*/

(function(){var e,t,n;(function(r){function c(e,t){var n=t&&t.split("/"),r=o.map,i=r&&r["*"]||{},s,u,a,f,l,c,h;if(e&&e.charAt(0)==="."&&t){n=n.slice(0,n.length-1),e=n.concat(e.split("/"));for(l=0;h=e[l];l++)if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))return!0;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}if((n||i)&&r){s=e.split("/");for(l=s.length;l>0;l-=1){u=s.slice(0,l).join("/");if(n)for(c=n.length;c>0;c-=1){a=r[n.slice(0,c).join("/")];if(a){a=a[u];if(a){f=a;break}}}f=f||i[u];if(f){s.splice(0,l,f),e=s.join("/");break}}}return e}function h(e,t){return function(){return l.apply(r,a.call(arguments,0).concat([e,t]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(t){i[e]=t}}function v(e){if(s.hasOwnProperty(e)){var t=s[e];delete s[e],u[e]=!0,f.apply(r,t)}if(!i.hasOwnProperty(e))throw new Error("No "+e);return i[e]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return o&&o.config&&o.config[e]||{}}}var i={},s={},o={},u={},a=[].slice,f,l;f=function(e,t,n,o){var a=[],f,l,c,p,y,b;o=o||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(b=0;b<t.length;b++){y=m(t[b],o),c=y.f;if(c==="require")a[b]=h(e);else if(c==="exports")a[b]=i[e]={},f=!0;else if(c==="module")l=a[b]={id:e,uri:"",exports:i[e],config:g(e)};else if(i.hasOwnProperty(c)||s.hasOwnProperty(c))a[b]=v(c);else if(y.p)y.p.load(y.n,h(o,!0),d(c),{}),a[b]=i[c];else if(!u[c])throw new Error(e+" missing "+c)}p=n.apply(i[e],a);if(e)if(l&&l.exports!==r&&l.exports!==i[e])i[e]=l.exports;else if(p!==r||!f)i[e]=p}else e&&(i[e]=n)},e=t=l=function(e,t,n,i){return typeof e=="string"?v(m(e,t).f):(e.splice||(o=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},f(r,e,t,n),l)},l.config=function(e){return o=e,l},n=function(e,t,n){t.splice||(n=t,t=[]),s[e]=[e,t,n]},n.amd={jQuery:!0}})(),n("lib-build/almond.js",function(){}),function(e,t){function r(e){return new i(e)}function i(e){if(e&&e._wrapped)return e;this._wrapped=e}function s(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||30),s=i?{}:e;if(i)for(var o=t-1;++o<r;)n=e[o]+"",(Z.call(s,n)?s[n]:s[n]=[]).push(e[o]);return function(e){if(i){var n=e+"";return Z.call(s,n)&&-1<b(s[n],e)}return-1<b(s,e,t)}}function o(){for(var e,t,n,r=-1,i=arguments.length,s={e:"",f:"",j:"",p:"",c:{d:""},m:{d:""}};++r<i;)for(t in e=arguments[r],e)n=(n=e[t])==A?"":n,/d|i/.test(t)?("string"==typeof n&&(n={b:n,l:n}),s.c[t]=n.b,s.m[t]=n.l):s[t]=n;e=s.a,t=/^[^,]+/.exec(e)[0],s.g=t,s.h=gt,s.k=Et,s.o=K,s.q=s.q!==O,s.r=s.r!==O,"n"in s||(s.n=bt),s.f||(s.f="if(!"+t+")return D");if("g"!=t||!s.c.i)s.c=A;t="",s.r&&(t+=""),t+="var n,p="+s.g+",D",s.j&&(t+="="+s.j),t+=";"+s.f+";"+s.p+";",s.c&&(t+="var s=p.length;n=-1;",s.m&&(t+="if(s===s>>>0){"),s.n&&(t+="if(J.call(p)==G){p=p.split('')}"),t+=s.c.d+";while(++n<s){"+s.c.i+"}",s.m&&(t+="}"));if(s.m){s.c&&(t+="else{"),s.h||(t+="var E=typeof p=='function'&&C.call(p,'prototype');"),s.k&&s.q?t+="var A=u(p),z=-1,s=A.length;"+s.m.d+";while(++z<s){n=A[z];if(!(E&&n=='prototype')){"+s.m.i+"}}":(t+=s.m.d+";for(n in p){",s.h?(s.q&&(t+="if(l.call(p,n)){"),t+=s.m.i+";",s.q&&(t+="}")):(t+="if(!(E&&n=='prototype')",s.q&&(t+="&&l.call(p,n)"),t+="){"+s.m.i+"}"),t+="}");if(s.h){t+="var i=p.constructor;";for(n=0;7>n;n++)t+="n='"+s.o[n]+"';if(","constructor"==s.o[n]&&(t+="!(i&&i.prototype===p)&&"),t+="l.call(p,n)){"+s.m.i+"}"}s.c&&(t+="}")}return t+=s.e+";return D",Function("c,d,h,j,l,m,r,x,u,C,F,G,J","return function("+e+"){"+t+"}")(at,T,u,ct,Z,C,c,xt,ut,tt,nt,dt,rt)}function u(e,n){return e=e.a,n=n.a,e===t?1:n===t?-1:e<n?-1:e>n?1:0}function a(e,t){return G[t]}function f(e){return"\\"+Tt[e]}function l(e){return St[e]}function c(e,t){return function(n,r,i){return e.call(t,n,r,i)}}function h(){}function p(e,t){if(q.test(t))return"<e%-"+t+"%>";var n=G.length;return G[n]="'+__e("+t+")+'",Q+n}function d(e,t,n,r){return e=G.length,t?G[e]="';"+t+";__p+='":n?G[e]="'+__e("+n+")+'":r&&(G[e]="'+((__t=("+r+"))==null?'':__t)+'"),Q+e}function v(e,t){if(q.test(t))return"<e%="+t+"%>";var n=G.length;return G[n]="'+((__t=("+t+"))==null?'':__t)+'",Q+n}function m(e,t,n,r){if(!e)return n;var i=e.length,s=3>arguments.length;r&&(t=c(t,r));if(i===i>>>0){var o=bt&&rt.call(e)==dt?e.split(""):e;for(i&&s&&(n=o[--i]);i--;)n=t(n,o[i],i,e);return n}o=en(e);for((i=o.length)&&s&&(n=e[o[--i]]);i--;)s=o[i],n=t(n,e[s],s,e);return n}function g(e,t,n){if(e)return t==A||n?e[0]:nt.call(e,0,t)}function y(e,t){var n=[];if(!e)return n;for(var r,i=-1,s=e.length;++i<s;)r=e[i],Yt(r)?et.apply(n,t?r:y(r)):n.push(r);return n}function b(e,t,n){if(!e)return-1;var r=-1,i=e.length;if(n){if("number"!=typeof n)return r=S(e,t),e[r]===t?r:-1;r=(0>n?Math.max(0,i+n):n)-1}for(;++r<i;)if(e[r]===t)return r;return-1}function w(e,t,n){var r=-Infinity,i=r;if(!e)return i;var s=-1,o=e.length;if(!t){for(;++s<o;)e[s]>i&&(i=e[s]);return i}for(n&&(t=c(t,n));++s<o;)n=t(e[s],s,e),n>r&&(r=n,i=e[s]);return i}function E(e,t,n){return e?nt.call(e,t==A||n?1:t):[]}function S(e,t,n,r){if(!e)return 0;var i=0,s=e.length;if(n){r&&(n=T(n,r));for(t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r}else for(;i<s;)r=i+s>>>1,e[r]<t?i=r+1:s=r;return i}function x(e,t,n,r){var i=[];if(!e)return i;var s=-1,o=e.length,u=[];"function"==typeof t&&(r=n,n=t,t=O);for(n?r&&(n=c(n,r)):n=C;++s<o;)if(r=n(e[s],s,e),t?!s||u[u.length-1]!==r:0>b(u,r))u.push(r),i.push(e[s]);return i}function T(e,t){function n(){var o=arguments,u=t;return i||(e=t[r]),s.length&&(o=o.length?Y.apply(s,o):s),this instanceof n?(h.prototype=e.prototype,u=new h,(o=e.apply(u,o))&&xt[typeof o]?o:u):e.apply(u,o)}var r,i=rt.call(e)==ct;if(i){if(wt||it&&2<arguments.length)return it.call.apply(it,arguments)}else r=t,t=e;var s=nt.call(arguments,2);return n}function N(e,t,n){n||(n=[]);if(e===t)return 0!==e||1/e==1/t;if(e==A||t==A)return e===t;e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&rt.call(e.isEqual)==ct)return e.isEqual(t);if(t.isEqual&&rt.call(t.isEqual)==ct)return t.isEqual(e);var r=rt.call(e);if(r!=rt.call(t))return O;switch(r){case dt:return e==""+t;case ht:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case ft:case lt:return+e==+t;case pt:return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return O;for(var i=n.length;i--;)if(n[i]==e)return L;var i=-1,s=L,o=0;n.push(e);if(r==at){if(o=e.length,s=o==t.length)for(;o--&&(s=N(e[o],t[o],n)););}else{if("constructor"in e!="constructor"in t||e.constructor!=t.constructor)return O;for(var u in e)if(Z.call(e,u)&&(o++,!(s=Z.call(t,u)&&N(e[u],t[u],n))))break;if(s){for(u in t)if(Z.call(t,u)&&!(o--))break;s=!o}if(s&&gt)for(;7>++i&&(u=K[i],!Z.call(e,u)||!!(s=Z.call(t,u)&&N(e[u],t[u],n))););}return n.pop(),s}function C(e){return e}function k(e){jt(Gt(e),function(t){var n=r[t]=e[t];i.prototype[t]=function(){var e=[this._wrapped];return arguments.length&&et.apply(e,arguments),e=n.apply(r,e),this._chain&&(e=new i(e),e._chain=L),e}})}var L=!0,A=null,O=!1,M,_,D,P,H="object"==typeof exports&&exports&&("object"==typeof global&&global&&global==global.global&&(e=global),exports),B=Array.prototype,j=Object.prototype,F=0,I=e._,q=/[-+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,R=/\b__p\+='';/g,U=/\b(__p\+=)''\+/g,z=/(__e\(.*?\)|\b__t\))\+'';/g,W=/(?:__e|__t=)\(\s*(?![\d\s"']|this\.)/g,X=RegExp("^"+(j.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),V=/__token__(\d+)/g,$=/[&<"']/g,J=/['\n\r\t\u2028\u2029\\]/g,K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Q="__token__",G=[],Y=B.concat,Z=j.hasOwnProperty,et=B.push,tt=j.propertyIsEnumerable,nt=B.slice,rt=j.toString,it=X.test(it=nt.bind)&&it,st=X.test(st=Array.isArray)&&st,ot=e.isFinite,ut=X.test(ut=Object.keys)&&ut,at="[object Array]",ft="[object Boolean]",lt="[object Date]",ct="[object Function]",ht="[object Number]",pt="[object RegExp]",dt="[object String]",vt=e.clearTimeout,mt=e.setTimeout,gt=!tt.call({valueOf:0},"valueOf"),yt="x"!=nt.call("x")[0],bt="xx"!="x"[0]+Object("x")[0],wt=it&&/\n|Opera/.test(it+rt.call(e.opera)),Et=ut&&/^.+$|true/.test(ut+!!e.attachEvent),St={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#x27;"},xt={"boolean":O,"function":L,object:L,number:O,string:O,"undefined":O},Tt={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};r.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:"obj"};var Nt={a:"g,e,I",j:"g",p:"if(!e){e=m}else if(I)e=r(e,I)",i:"e(p[n],n,g)"},Ct={j:"true",i:"if(!e(p[n],n,g))return!D"},kt={q:O,r:O,a:"w",j:"w",p:"for(var q=1,s=arguments.length;q<s;q++){p=arguments[q];"+(gt?"if(p){":""),i:"D[n]=p[n]",e:(gt?"}":"")+"}"},Lt={j:"[]",i:"e(p[n],n,g)&&D.push(p[n])"},At={p:"if(I)e=r(e,I)"},Ot={i:{l:Nt.i}},Mt={j:"",f:"if(!g)return[]",d:{b:"D=Array(s)",l:"D="+(Et?"Array(s)":"[]")},i:{b:"D[n]=e(p[n],n,g)",l:"D"+(Et?"[z]=":".push")+"(e(p[n],n,g))"}},_t=o({a:"w",f:"if(!(w&&x[typeof w]))throw TypeError()",j:"[]",i:"D.push(n)"}),Dt=o({a:"g,H",j:"false",n:O,d:{b:"if(J.call(p)==G)return g.indexOf(H)>-1"},i:"if(p[n]===H)return true"}),Pt=o(Nt,Ct),Ht=o(Nt,Lt),Bt=o(Nt,At,{j:"",i:"if(e(p[n],n,g))return p[n]"}),jt=o(Nt,At),Ft=o(Nt,{j:"{}",p:"var y,o=typeof e=='function';if(o&&I)e=r(e,I)",i:"y=o?e(p[n],n,g):p[n][e];(l.call(D,y)?D[y]:D[y]=[]).push(p[n])"}),It=o(Mt,{a:"g,t",p:"var b=F.call(arguments,2),o=typeof t=='function'",i:{b:"D[n]=(o?t:p[n][t]).apply(p[n],b)",l:"D"+(Et?"[z]=":".push")+"((o?t:p[n][t]).apply(p[n],b))"}}),qt=o(Nt,Mt),Rt=o(Mt,{a:"g,B",i:{b:"D[n]=p[n][B]",l:"D"+(Et?"[z]=":".push")+"(p[n][B])"}}),Ut=o({a:"g,e,a,I",j:"a",p:"var v=arguments.length<3;if(I)e=r(e,I)",d:{b:"if(v)D=g[++n]"},i:{b:"D=e(D,p[n],n,g)",l:"D=v?(v=false,p[n]):e(D,p[n],n,g)"}}),zt=o(Nt,Lt,{i:"!"+Lt.i}),Wt=o(Nt,Ct,{j:"false",i:Ct.i.replace("!","")}),Xt=o(Nt,Mt,{p:"if(typeof e=='string'){var y=e;e=function(g){return g[y]}}else if(I)e=r(e,I)",i:{b:"D[n]={a:e(p[n],n,g),b:p[n]}",l:"D"+(Et?"[z]=":".push")+"({a:e(p[n],n,g),b:p[n]})"},e:"D.sort(h);s=D.length;while(s--){D[s]=D[s].b}"}),Vt=o({q:O,r:O,a:"w",j:"w",p:"var k=arguments,s=k.length;if(s>1){for(var n=1;n<s;n++)D[k[n]]=d(D[k[n]],D);return D}",i:"if(J.call(D[n])==j)D[n]=d(D[n],D)"}),$t=o(kt,{i:"if(D[n]==null)"+kt.i}),Jt=o(kt),Kt=o(Nt,At,Ot,{q:O}),Qt=o(Nt,At,Ot),Gt=o({q:O,a:"w",j:"[]",i:"if(J.call(p[n])==j)D.push(n)",e:"D.sort()"});jt({Arguments:"[object Arguments]",Date:lt,Function:ct,Number:ht,RegExp:pt,String:dt},function(e,t){r["is"+t]=function(t){return rt.call(t)==e}}),r.isArguments(arguments)||(r.isArguments=function(e){return!!e&&!!Z.call(e,"callee")});var Yt=st||function(e){return rt.call(e)==at},Zt=o({a:"K",j:"true",p:"var f=J.call(K);if(f==c||f==G)return!K.length",i:{l:"return false"}}),en=ut?function(e){return"function"==typeof e&&tt.call(e,"prototype")?_t(e):ut(e)}:_t,tn=o({a:"w",j:"[]",i:"D.push(p[n])"});r.VERSION="0.4.2",r.after=function(e,t){return 1>e?t():function(){if(1>--e)return t.apply(this,arguments)}},r.bind=T,r.bindAll=Vt,r.chain=function(e){return e=new i(e),e._chain=L,e},r.clone=function(e){return e&&xt[typeof e]?Yt(e)?e.slice():Jt({},e):e},r.compact=function(e){var t=[];if(!e)return t;for(var n=-1,r=e.length;++n<r;)e[n]&&t.push(e[n]);return t},r.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},r.contains=Dt,r.debounce=function(e,t,n){function r(){u=A,n||e.apply(o,i)}var i,s,o,u;return function(){var a=n&&!u;return i=arguments,o=this,vt(u),u=mt(r,t),a&&(s=e.apply(o,i)),s}},r.defaults=$t,r.defer=function(e){var n=nt.call(arguments,1);return mt(function(){return e.apply(t,n)},1)},r.delay=function(e,n){var r=nt.call(arguments,2);return mt(function(){return e.apply(t,r)},n)},r.difference=function(e){var t=[];if(!e)return t;for(var n=-1,r=e.length,i=Y.apply(t,arguments),i=s(i,r);++n<r;)i(e[n])||t.push(e[n]);return t},r.escape=function(e){return e==A?"":(e+"").replace($,l)},r.every=Pt,r.extend=Jt,r.filter=Ht,r.find=Bt,r.first=g,r.flatten=y,r.forEach=jt,r.forIn=Kt,r.forOwn=Qt,r.functions=Gt,r.groupBy=Ft,r.has=function(e,t){return Z.call(e,t)},r.identity=C,r.indexOf=b,r.initial=function(e,t,n){return e?nt.call(e,0,-(t==A||n?1:t)):[]},r.intersection=function(e){var t=[];if(!e)return t;for(var n,r=-1,i=e.length,o=nt.call(arguments,1),u=[];++r<i;)n=e[r],0>b(t,n)&&Pt(o,function(e,t){return(u[t]||(u[t]=s(e)))(n)})&&t.push(n);return t},r.invoke=It,r.isArray=Yt,r.isBoolean=function(e){return e===L||e===O||rt.call(e)==ft},r.isElement=function(e){return!!e&&1==e.nodeType},r.isEmpty=Zt,r.isEqual=N,r.isFinite=function(e){return ot(e)&&rt.call(e)==ht},r.isNaN=function(e){return rt.call(e)==ht&&e!=+e},r.isNull=function(e){return e===A},r.isObject=function(e){return e&&xt[typeof e]},r.isUndefined=function(e){return e===t},r.keys=en,r.last=function(e,t,n){if(e){var r=e.length;return t==A||n?e[r-1]:nt.call(e,-t||r)}},r.lastIndexOf=function(e,t,n){if(!e)return-1;var r=e.length;for(n&&"number"==typeof n&&(r=(0>n?Math.max(0,r+n):Math.min(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},r.map=qt,r.max=w,r.memoize=function(e,t){var n={};return function(){var r=t?t.apply(this,arguments):arguments[0];return Z.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}},r.min=function(e,t,n){var r=Infinity,i=r;if(!e)return i;var s=-1,o=e.length;if(!t){for(;++s<o;)e[s]<i&&(i=e[s]);return i}for(n&&(t=c(t,n));++s<o;)n=t(e[s],s,e),n<r&&(r=n,i=e[s]);return i},r.mixin=k,r.noConflict=function(){return e._=I,this},r.once=function(e){var t,n=O;return function(){return n?t:(n=L,t=e.apply(this,arguments))}},r.partial=function(e){var t=nt.call(arguments,1),n=t.length;return function(){var r;return r=arguments,r.length&&(t.length=n,et.apply(t,r)),r=1==t.length?e.call(this,t[0]):e.apply(this,t),t.length=n,r}},r.pick=function(e){for(var t,n=0,r=Y.apply(B,arguments),i=r.length,s={};++n<i;)t=r[n],t in e&&(s[t]=e[t]);return s},r.pluck=Rt,r.range=function(e,t,n){n||(n=1),t==A&&(t=e||0,e=0);for(var r=-1,t=Math.max(0,Math.ceil((t-e)/n)),i=Array(t);++r<t;)i[r]=e,e+=n;return i},r.reduce=Ut,r.reduceRight=m,r.reject=zt,r.rest=E,r.result=function(e,t){if(!e)return A;var n=e[t];return rt.call(n)==ct?e[t]():n},r.shuffle=function(e){if(!e)return[];for(var t,n=-1,r=e.length,i=Array(r);++n<r;)t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e[n];return i},r.size=function(e){if(!e)return 0;var t=e.length;return t===t>>>0?e.length:en(e).length},r.some=Wt,r.sortBy=Xt,r.sortedIndex=S,r.tap=function(e,t){return t(e),e},r.template=function(e,t,n){n||(n={});var i,s;i=n.escape;var o=n.evaluate,u=n.interpolate,l=r.templateSettings,n=n.variable;i==A&&(i=l.escape),o==A&&(o=l.evaluate),u==A&&(u=l.interpolate),i&&(e=e.replace(i,p)),u&&(e=e.replace(u,v)),o!=M&&(M=o,P=RegExp((o?o.source:"($^)")+"|<e%-([\\s\\S]+?)%>|<e%=([\\s\\S]+?)%>","g")),i=G.length,e=e.replace(P,d),i=i!=G.length,e="__p += '"+e.replace(J,f).replace(V,a)+"';",G.length=0,n||(n=l.variable||_||"obj",i?e="with("+n+"){"+e+"}":(n!=_&&(_=n,D=RegExp("(\\(\\s*)"+n+"\\."+n+"\\b","g")),e=e.replace(W,"$&"+n+".").replace(D,"$1__d"))),e=(i?e.replace(R,""):e).replace(U,"$1").replace(z,"$1;"),e="function("+n+"){"+n+"||("+n+"={});var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":",__d="+n+"."+n+"||"+n+";")+e+"return __p}";try{s=Function("_","return "+e)(r)}catch(c){s=function(){throw c}}return t?s(t):(s.source=e,s)},r.throttle=function(e,t){function n(){u=new Date,o=A,e.apply(s,r)}var r,i,s,o,u=0;return function(){var a=new Date,f=t-(a-u);return r=arguments,s=this,0>=f?(u=a,i=e.apply(s,r)):o||(o=mt(n,f)),i}},r.times=function(e,t,n){var r=-1;if(n)for(;++r<e;)t.call(n,r);else for(;++r<e;)t(r)},r.toArray=function(e){if(!e)return[];if(e.toArray&&rt.call(e.toArray)==ct)return e.toArray();var t=e.length;return t===t>>>0?(yt?rt.call(e)==dt:"string"==typeof e)?e.split(""):nt.call(e):tn(e)},r.union=function(){for(var e=-1,t=[],n=Y.apply(t,arguments),r=n.length;++e<r;)0>b(t,n[e])&&t.push(n[e]);return t},r.uniq=x,r.uniqueId=function(e){var t=F++;return e?e+t:t},r.values=tn,r.without=function(e){var t=[];if(!e)return t;for(var n=-1,r=e.length,i=s(arguments,1,20);++n<r;)i(e[n])||t.push(e[n]);return t},r.wrap=function(e,t){return function(){var n=[e];return arguments.length&&et.apply(n,arguments),t.apply(this,n)}},r.zip=function(e){if(!e)return[];for(var t=-1,n=w(Rt(arguments,"length")),r=Array(n);++t<n;)r[t]=Rt(arguments,t);return r},r.zipObject=function(e,t){if(!e)return{};var n=-1,r=e.length,i={};for(t||(t=[]);++n<r;)i[e[n]]=t[n];return i},r.all=Pt,r.any=Wt,r.collect=qt,r.detect=Bt,r.each=jt,r.foldl=Ut,r.foldr=m,r.head=g,r.include=Dt,r.inject=Ut,r.methods=Gt,r.select=Ht,r.tail=E,r.take=g,r.unique=x,i.prototype=r.prototype,k(r),i.prototype.chain=function(){return this._chain=L,this},i.prototype.value=function(){return this._wrapped},jt("pop push reverse shift sort splice unshift".split(" "),function(e){var t=B[e];i.prototype[e]=function(){var e=this._wrapped;return t.apply(e,arguments),e.length===0&&delete e[0],this._chain&&(e=new i(e),e._chain=L),e}}),jt(["concat","join","slice"],function(e){var t=B[e];i.prototype[e]=function(){var e=t.apply(this._wrapped,arguments);return this._chain&&(e=new i(e),e._chain=L),e}}),typeof n=="function"&&typeof n.amd=="object"&&n.amd?(e._=r,n("underscore",[],function(){return r})):H?"object"==typeof module&&module&&module.s==H?(module.s=r)._=r:H._=r:e._=r}(this),n("util/checksum",[],function(){return function(e,t,n,r,i){for(t=n=r=0;i=e.charCodeAt(r++);n=(n+t)%255)t=(t+i)%255;return n<<8|t}}),n("api/api",["underscore","util/checksum"],function(e,t){var n=this,r={_config:{format:"json",normalize:!1,apiversion:"5.3",timeKey:"LastModeratedTime",baseUrl:"http://reviews.apitestcustomer.bazaarvoice.com/bvstaging/data/",passkey:"3d9fiq4371xcuvt7sjsqdy9ki"}},i={">":"gt",">=":"gte","<":"lt","<=":"lte","=":"eq","!=":"neq"},s={"+":"asc","-":"desc"},o=[["review","reviews","with"],["question","questions"],["answer","answers"],["story","stories"],["reviewComment","reviewComments","with"],["storyComment","storyComments","with"],["author","authors","from"],["photo","photos","with"],["video","videos","with"],["product","products"],["category","categories","in"],["statistic","statistics","with"]],u=function(e,t){return new u.fn.init(e,t)},a={offset:function(e){return this.mods.offset=e,this},limit:function(e){return this.mods.limit=e,this},search:function(e){return this.mods.search=e,this},sortBy:function(e,t){return typeof t=="undefined"&&(t=e,e="desc"),this.mods.sorts.push({dir:(""+e).toLowerCase(),key:(""+t).toLowerCase()}),this},filterBy:function(e,t,n){return typeof t=="undefined"&&typeof n=="undefined"?(t="=",n="true"):typeof n=="undefined"&&(n=t,t="="),this.mods.filters.push({key:(""+e).toLowerCase(),operator:(""+t).toLowerCase(),value:(""+n).toLowerCase()}),this},end:function(){return this.self._get.call(this.self,this.type,this.mods)}};e.extend(r,{get:u,config:function(t){return r._config=e.extend(r._config,t),this},warn:function(e,t){n.console&&n.console.log&&n.console.log("BV API JS lib warning: "+e,t)}}),e(o).forEach(function(t){r[t[0]]=r[t[1]]=function(n){return n&&!e.isArray(n)&&(n=e.toArray(arguments)),this.get(t[1],n)}}),u.fn=u.prototype={constructor:u,init:function(t,n){return this.config=e.extend({},r._config),this._data={displayContentType:t},n?this.filterBy("id","=",n):this},as:function(e){return this.config.format=e,this},withFormat:function(e){return this.as(e)},withNormalize:function(e){return this.config.normalize=e,this},withPasskey:function(e){return this.config.passkey=e,this},withBaseUrl:function(e){return this.config.baseUrl=e,this},inLocale:function(e){return this.config.locale=e,this},locale:function(e){return this.inLocale(e)},include:function(t){return arguments.length>1?t=e.toArray(arguments):t&&!e.isArray(t)&&(t=[t]),this.config.include=e.union(this.config.include||[],t||[]),this},offset:function(e){return this.config.offset=e,this},offsetBy:function(e){return this.offset(e)},limit:function(e){return this.config.limit=e,this},limitTo:function(e){return this.limit(e)},page:function(e){var t=this;return this.config.limit||(r.warn("You are calling `page` without setting the number per page. Using 10 as your `limit`."),t=this.limit(10)),t.offset(e*this.config.limit-this.config.limit)},onPage:function(e){return this.page(e)},_get:function(t,n){var o=this;return!t||!n?(r.warn("Invalid use of _get private function.",arguments),this):(t=t.toLowerCase(),o._data.subfilters=o._data.subfilters||{},e(n.filters).forEach(function(e){e.operator=i[e.operator]||e.operator,o._data.subfilters[t]=o._data.subfilters[t]||{},o._data.subfilters[t][e.key]=o._data.subfilters[t][e.key]||{},o._data.subfilters[t][e.key][e.operator]=o._data.subfilters[t][e.key][e.operator]||[],o._data.subfilters[t][e.key][e.operator].push(e.value)}),e(n.sorts).forEach(function(e){e.dir=s[e.dir]||e.dir,o._data.subsorts=o._data.subsorts||{},o._data.subsorts[t]=o._data.subsorts[t]||[],o._data.subsorts[t].push(e)}),n.limit&&(o._data.sublimits=o._data.sublimits||{},o._data.sublimits[t]=n.limit),n.offset&&(o._data.suboffsets=o._data.suboffsets||{},o._data.suboffsets[t]=n.offset),n.search&&(o._data.subsearch=o._data.subsearch||{},o._data.subsearch[t]=n.search),this.include(t))},get:function(e,t){var n={filters:[],sorts:[]},r=function(){},i;return r.prototype=a,i=new r,i.mods=n,i.type=e,i.self=this,i.config=this.config,t?i.filterBy("id","=",t):i},filterIncluded:function(e,t,n,r){var i=this;return arguments.length>1?i.get.call(i,e).filterBy(t,n,r).end():{by:function(t,n,r){return i.get.call(i,e).filterBy(t,n,r).end()}}},sortIncluded:function(e,t,n){var r=this;return arguments.length>1?r.get.call(r,e).sortBy(t,n).end():{by:function(t,n){return r.get.call(r,e).sortBy(t,n).end()}}},offsetIncluded:function(e,t){var n=this;return arguments.length>1?n.get.call(n,e).offset(t).end():{by:function(t){return n.get.call(n,e).offset(t).end()}}},limitIncluded:function(t,n){var r=this;return arguments.length>1?r.get.call(r,t).limit(n).end():{to:function(e){return r.get.call(r,t).limit(e).end()},by:function(){return this.to.apply(this,e.toArray(arguments))}}},searchIncluded:function(e,t){var n=this;return arguments.length>1?n.get.call(n,e).search(t).end():{on:function(t){return n.get.call(n,e).search(t).end()},by:function(t){return n.get.call(n,e).search(t).end()}}},withStatsOn:function(t){return arguments.length>1?t=e.toArray(arguments):t&&!e.isArray(t)&&(t=[t]),this.config.stats=e.union(this.config.stats||[],t),this},stats:function(){return this.withStatsOn.apply(this,arguments)},withSearchOn:function(e){return this.config.search=e,this},search:function(){return this.withSearchOn.apply(this,arguments)},sortBy:function(e,t){return t||(t=e,e="desc"),e=s[e]||e,this._data.sorts=this._data.sorts||[],this._data.sorts.push({key:(""+t).toLowerCase(),dir:(""+e).toLowerCase()}),this},filterBy:function(t,n,r){var s=this;return t=t.toLowerCase(),typeof r=="undefined"&&(n?(r=n,n="="):(n="=",r="true")),r=""+r,i[n]&&(n=i[n]),this._data.filters=this._data.filters||{},this._data.filters[t]=this._data.filters[t]||{},this._data.filters[t][n]=this._data.filters[t][n]||[],e.isArray(r)||(r=[r]),e(r).forEach(function(e){s._data.filters[t][n].push(e)}),this},checksum:function(e){return t(this.serialize()+(e||""))},serialize:function(t){var r=this,i=[],s=this._data,o="";return o+=s.displayContentType,o+="."+this.config.format,i.push({key:"passkey",val:r.config.passkey}),i.push({key:"apiversion",val:r.config.apiversion}),e(s.filters).forEach(function(t,n){e(t).forEach(function(t,r){t.length&&i.push({key:"filter",val:n+":"+r+":"+e(t).uniq().join(",")})})}),s.sorts&&s.sorts.length&&i.push({key:"sort",val:e(s.sorts).chain().uniq(!1,function(e){return e.key}).map(function(e){return e.key+":"+e.dir}).value().join(",")}),this.config.stats&&this.config.stats.length&&i.push({key:"stats",val:e(this.config.stats).chain().map(function(e){return e.toLowerCase()}).uniq().value().join(",")}),this.config.include&&this.config.include.length&&i.push({key:"include",val:e(this.config.include).chain().map(function(e){return e.toLowerCase()}).uniq().value().join(",")}),e(s.subfilters).forEach(function(t,n){e(t).forEach(function(t,r){e(t).forEach(function(t,s){t.length&&i.push({key:"filter_"+n,val:r+":"+s+":"+e(t).uniq().join(",")})})})}),e(s.subsorts).forEach(function(t,n){i.push({key:"sort_"+n,val:e(t).chain().uniq(!1,function(e){return e.key}).map(function(e){return e.key+":"+e.dir}).value().join(",")})}),(this.config.limit||this.config.limit===0)&&i.push({key:"limit",val:this.config.limit}),(this.config.offset||this.config.offset===0)&&i.push({key:"offset",val:this.config.offset}),this.config.search&&i.push({key:"search",val:this.config.search}),e(s.sublimits).forEach(function(e,t){i.push({key:"limit_"+t,val:e})}),e(s.suboffsets).forEach(function(e,t){i.push({key:"offset_"+t,val:e})}),e(s.subsearch).forEach(function(e,t){i.push({key:"search_"+t,val:e})}),this.config.locale&&i.push({key:"locale",val:this.config.locale}),i=e(i).map(function(e){return t?e.key+"="+e.val:n.encodeURIComponent(e.key)+"="+n.encodeURIComponent(e.val)}).join("&"),this.config.baseUrl?this.config.baseUrl+o+"?"+i:o+"?"+i}},e(o).forEach(function(t){var n=t[0].substr(0,1).toUpperCase()+t[0].substr(1),r=t[1].substr(0,1).toUpperCase()+t[1].substr(1),i=["for"];t[2]&&i.push(t[2]),e(i).forEach(function(i){u.fn[i+r]=a[i+r]=function(n){return n?(n&&!e.isArray(n)&&(n=e.toArray(arguments)),this.filterBy(t[0]+"id","=",n)):this},u.fn[i+n]=a[i+n]=function(e){return e?this[i+r]([e]):this}})});var f={before:function(e,t){return this.filterBy(this.config.timeKey,t===!1?"<":"<=",e)},after:function(e,t){return this.filterBy(this.config.timeKey,t?">=":">",e)}};return e.extend(u.fn,f),e.extend(a,f),u.fn.init.prototype=u.fn,a.constructor=u.fn.get,r}),n("api/submit",["api/api","underscore","util/checksum"],function(e,t,n){var r=this,i=[["review"],["question"],["answer"],["story"],["reviewComment"],["storyComment"],["photo","upload"],["video","upload"],["feedback"]],s=["productId","action","agreeToTermsAndConditions","callback","campaignId","hostedAuthentication_authenticatedEmail","hostedAuthentication_callbackUrl","isRecommended","netPromoterComment","netPromoterScore","rating","reviewText","sendEmailAlertWhenCommented","sendEmailAlertWhenPublished","title","user","userEmail","userId","userLocation","userNickname","questionSummary","isUserAnonymous","questionDetails","categoryId","answerText","questionId","storyText","reviewId","commentText","storyId","photo","video","feedbackType","vote","reasonText","contentId","contentType"],o=["additionalField","contextDataValue","rating","tagId"],u=["photoCaption","photoUrl","productRecommendationId","videoCaption","videoUrl"],a=["tag"],f=function(e,t){return new f.fn.init(e,t)};return f.fn=f.prototype={constructor:f,init:function(n,r){return this.config=t.extend({},e._config),this._data={submitContentType:n.toLowerCase(),submitPrefix:"submit"},r&&(this._data.submitPrefix=r),this},as:function(e){return this.config.format=e,this},withFormat:function(e){return this.as(e)},withPasskey:function(e){return this.config.passkey=e,this},withBaseUrl:function(e){return this.config.baseUrl=e,this},inLocale:function(e){return this.config.locale=e,this},locale:function(e){return this.inLocale(e)},withSubject:function(e,t){return typeof t=="undefined"&&(t="true"),this._data[e]=t,this},withNthSubject:function(e,n){return typeof n=="undefined"&&(n="true"),this._data[e]=t.union(this._data[e]||[],n),this},withDimensionIdentifiedSubject:function(e,t,n){var r=e+"_"+t;return this.withSubject(r,n)},withNthDimensionIdentifiedSubject:function(e,t,n){var r=e+"_"+t;return this.withNthSubject(r,n)},checksum:function(e){return n(this.serialize()+(e||""))},getHierarchialPartString:function(){var e=this._data.submitPrefix+this._data.submitContentType+"."+this.config.format;return this.config.baseUrl?this.config.baseUrl+e:e},getParamsHash:function(){var e=this,n={},r=this._data;return n.passkey=e.config.passkey,n.apiversion=e.config.apiversion,this.config.locale&&(n.locale=this.config.locale),t(r).forEach(function(e,r,i){if(t(e).isArray())for(var s=0;s<e.length;s++){var o=r+"_"+(s+1);n[o]=e[s]}else{if(r==="submitContentType"||r==="submitPrefix")return!0;n[r]=e}}),n},getQueryString:function(e){var t=this.getParamsHash(),n=[];for(var i in t)e?n.push(i+"="+t[i]):n.push(r.encodeURIComponent(i)+"="+r.encodeURIComponent(t[i]));return n.join("&")},serialize:function(e){return this.getHierarchialPartString()+"?"+this.getQueryString(e)}},t(i).forEach(function(t){var n=t[1]===undefined?"submit":t[1],r=t[0].substr(0,1).toUpperCase()+t[0].substr(1);e[n+r]=function(){return this.submit(t[0],n)}}),t(s).forEach(function(e){var t=e.substr(0,1).toUpperCase()+e.substr(1);f.fn[e]=f.fn["with"+t]=function(t){return this.withSubject(e,t)}}),t(u).forEach(function(e){var t=e.substr(0,1).toUpperCase()+e.substr(1);f.fn[e]=f.fn["with"+t]=function(t){return this.withNthSubject(e,t)}}),t(o).forEach(function(e){var t=e.substr(0,1).toUpperCase()+e.substr(1)+"_";f.fn[e+"_"]=f.fn["with"+t]=function(t,n){return this.withDimensionIdentifiedSubject(e,t,n)}}),t(a).forEach(function(e){var t=e.substr(0,1).toUpperCase()+e.substr(1)+"_";f.fn[e+"_"]=f.fn["with"+t]=function(t,n){return this.withNthDimensionIdentifiedSubject(e,t,n)}}),f.fn.init.prototype=f.fn,e.submit=f,e}),n("api/normalizer",["underscore"],function(e){function u(e,t,n){return t.nme=e,t.sample=n,t}function a(t,n,r){return e(n).forEach(function(i){if(!i||!r)return n;if(i[t+"Id"])i[t]=r[i[t+"Id"]];else if(i[t+"Ids"]){var s=[];e.forEach(i[t+"Ids"],function(e){s.push(r[e])}),i[t+"s"]=s}}),n}function f(t){return e(t).forEach(function(t){e(r).forEach(function(n){t[n+"Order"]&&t[n+"Order"].length&&(t[n+"Ordered"]=[],e(t[n+"Order"]).forEach(function(e){t[n+"Ordered"].push(t[n][e])}))})}),t}function l(t){return e(t).forEach(function(n,r){if(e.isObject(n)&&e.isEmpty(n)){t[r]=null;return}e.isObject(n)&&e(n).forEach(function(t,r){e.isObject(t)&&e.isEmpty(t)&&(n[r]=null)})}),t}function c(t,n){var r;return n?(n=n.toLowerCase(),i[n]?(e.isArray(t)?e(t).each(function(e){e&&c(e,n)}):(r=h(t),e(o).each(function(s){e(i[n][s.nme]).forEach(function(e){s(e,t,r)})}),r.each(function(e,t){c(e,t)})),t):t):t}function h(t){function o(e){var t=e.toLowerCase();return t=s[t]||t,t}var n=[],r;return r={push:function(e,t){if(!e||typeof e!="object")return this;var r=o(t);return i[r]?(n.push({contentType:r,entity:e}),this):this},each:function(t){return e(n).each(function(e){t(e.entity,e.contentType)}),this}},e(t).each(function(e,t){r.push(e,t)}),r}var t=[["Author","Authors"],["Comment","Comments"],["Product","Products"],["Category","Categories"]],n=["ReviewStatistics","QuestionStatistics","AnswerStatistics","StoryStatistics"],r=["SecondaryRatings","ContextDataValues","TagDimensions","Badges"],i={reviewstatistics:{add:[{key:"ContentType",val:"reviewstatistics"}],change:[{from:"FeaturedReviewCount",to:"FeaturedCount"},{from:"TotalReviewCount",to:"TotalCount"},{from:"RatingsOnlyReviewCount",to:"RatingsOnlyCount"}],sum:[{add1:"NotRecommendedCount",add2:"RecommendedCount",sum:"TotalRecommendedCount"},{add1:"HelpfulVoteCount",add2:"NotHelpfulVoteCount",sum:"TotalHelpfulVoteCount"}],ensure:[{firstKey:"RatingDistribution",secondKey:"RatingValue",defaultTo:[{Count:0,RatingValue:1},{Count:0,RatingValue:2},{Count:0,RatingValue:3},{Count:0,RatingValue:4},{Count:0,RatingValue:5}]}]},questionstatistics:{add:[{key:"ContentType",val:"questionstatistics"}],change:[{from:"HelpfulVoteCount",to:"DELETEME"},{from:"FeaturedQuestionCount",to:"FeaturedCount"},{from:"TotalQuestionCount",to:"TotalCount"},{from:"FirstQuestionTime",to:"FirstSubmissionTime"},{from:"LastQuestionTime",to:"LastSubmissionTime"},{from:"QuestionHelpfulVoteCount",to:"HelpfulVoteCount"},{from:"QuestionNotHelpfulVoteCount",to:"NotHelpfulVoteCount"}],remove:["DELETEME","FirstAnswerTime","LastAnswerTime","AnswerHelpfulVoteCount","AnswerNotHelpfulVoteCount","FeaturedAnswerCount","TotalAnswerCount","BestAnswerCount"]},answerstatistics:{add:[{key:"ContentType",val:"answerstatistics"}],change:[{from:"HelpfulVoteCount",to:"DELETEME"},{from:"FeaturedAnswerCount",to:"FeaturedCount"},{from:"TotalAnswerCount",to:"TotalCount"},{from:"FirstAnswerTime",to:"FirstSubmissionTime"},{from:"LastAnswerTime",to:"LastSubmissionTime"},{from:"AnswerHelpfulVoteCount",to:"HelpfulVoteCount"},{from:"AnswerNotHelpfulVoteCount",to:"NotHelpfulVoteCount"},{from:"BestAnswerCount",to:"BestCount"}],remove:["DELETEME","FirstQuestionTime","LastQuestionTime","QuestionHelpfulVoteCount","QuestionNotHelpfulVoteCount","FeaturedQuestionCount","TotalQuestionCount","LastQuestionAnswerTime"]},products:{add:[{key:"ContentType",val:"product"}],change:[{from:"ProductPageUrl",to:"Url"}],copy:[{from:"QAStatistics",to:"QuestionStatistics"},{from:"QAStatistics",to:"AnswerStatistics"}],ensure:[{firstKey:"TotalReviewCount",defaultTo:0}]},users:{add:[{key:"ContentType",val:"user"}],copy:[{from:"QAStatistics",to:"QuestionStatistics"},{from:"QAStatistics",to:"AnswerStatistics"}],remove:["QAStatistics"]},categories:{add:[{key:"ContentType",val:"category"}],change:[{from:"CategoryPageUrl",to:"Url"}],copy:[{from:"QAStatistics",to:"QuestionStatistics"},{from:"QAStatistics",to:"AnswerStatistics"}]},reviews:{add:[{key:"ContentType",val:"review"}],change:[{from:"ReviewText",to:"Text"},{from:"ProductId",to:"ReferenceId"},{from:"Product",to:"Reference"}],copy:[],remove:["Pros","Cons","UserNickname"],merge:[{into:"Author.DisplayName",first:"Author.DisplayName",second:"UserNickname"}]},questions:{add:[{key:"ContentType",val:"question"}],change:[{from:"CategoryId",to:"ReferenceId",ifValueExists:!0},{from:"Category",to:"Reference"},{from:"ProductId",to:"ReferenceId",ifValueExists:!0},{from:"Product",to:"Reference"},{from:"QuestionSummary",to:"Text"}]},answers:{add:[{key:"ContentType",val:"answer"}],change:[{from:"QuestionId",to:"ReferenceId"},{from:"AnswerText",to:"Text"}]},stories:{add:[{key:"ContentType",val:"story"}],change:[{from:"CategoryId",to:"ReferenceId"},{from:"ProductId",to:"ReferenceId"},{from:"StoryText",to:"Text"}]},comments:{add:[{key:"ContentType",val:"comment"}],change:[{from:"ReviewId",to:"ReferenceId"},{from:"StoryId",to:"ReferenceId"},{from:"CommentText",to:"Text"}]},clientreponses:{add:[{key:"ContentType",val:"response"}]}},s={product:"products",category:"categories",author:"users"},o=[u("change",function(e,t){if(e.from in t&&t.hasOwnProperty(e.from)){if(e.ifValueExists&&!t[e.from])return;t[e.to]=t[e.from],delete t[e.from]}},{from:"required",to:"required",ifValueExists:"optional"}),u("add",function(e,t){t[e.key]=e.val},{key:"required",val:"required"}),u("sum",function(e,t){t[e.sum]=t[e.add1]+t[e.add2]},{add1:"required",add2:"required",sum:"required"}),u("copy",function(t,n,r){if(t.from in n){var i=e(n[t.from]).clone();n[t.to]=i,r.push(i,t.to)}},{from:"required",to:"required"}),u("clone",function(e,t){e.from in t&&(t[e.to]=t[e.from])},{from:"required",to:"required"}),u("ensure",function(t,n){var r=t.firstKey.split("."),i=n,s;e(r).forEach(function(e,t){t<r.length-1?i[e]?i=i[e]:(i[e]={},i=i[e]):s=e});if(!t.secondKey)i[s]||(i[s]=t.defaultTo);else{var o=t.secondKey,u=i[s],a=e(u).pluck(o),f=e(t.defaultTo).filter(function(t){return!e(a).include(t[o])}),l=e.union(f,u);i[s]=e(l).sortBy(function(e){return e[o]})}},{firstKey:"required",defaultTo:"required"}),u("merge",function(t,n){var r=t.into.split("."),i=t.first.split("."),s=t.second.split("."),o=n,u,a=n,f=n;e(r).forEach(function(e,t){t<r.length-1?o[e]?o=o[e]:(o[e]={},o=o[e]):u=e}),e(i).forEach(function(e){a&&(a=a[e])}),a?o[u]=a:(e(s).forEach(function(e){f&&(f=f[e])}),f&&(o[u]=f))},{into:"required",first:"required"}),u("remove",function(e,t){delete t[e]},[])];return{normalize:function(n,r){if(!n)return[];r=e.extend({},r);var i=e.clone(n),s=i.Results;return i.Form?i:(i.Includes&&e(t).forEach(function(n){e(t).forEach(function(e){i.Includes[n[1]]&&(i.Includes[n[1]]=a(e[0],i.Includes[n[1]],i.Includes[e[1]]),i.Includes[n[1]]=l(i.Includes[n[1]]),i.Includes[n[1]]=f(i.Includes[n[1]]))}),s=a(n[0],s,i.Includes[n[1]])}),s=f(s),s=l(s),r.disableUniversal||(s=c(s,(r.contentType||"").toLowerCase())),{TotalResults:i.TotalResults,Results:s})},getInternalsForTestingUseOnly:function(){return{typeMap:i,synonyms:s,actions:o}}}}),n("api/send-ti",["api/api","api/submit","api/normalizer"],function(e,t,n){function i(e,t){r._config.normalize&&(e=r.normalize(e,{contentType:self._data.contentType}));if(t&&t.success)return t.success(e);r.warn("No success callback supplied: ",e)}function s(e,t){if(t&&t.error)return t.error(e);r.warn("No error callback supplied: ",e)}var r=t||e;return r.normalize=function(e,t){return n.normalize(e,t)},r.get.fn.send=function(e){var t=this,n=t.serialize(),o;Titanium&&Titanium.Network?(o=Titanium.Network.createHTTPClient(),o.onload=function(){i(JSON.parse(this.responseText),e)},o.onerror=function(t){r.warn("ERROR!",t.error),s(t.error,e)},o.open("GET",n),o.send()):r.warn("Titanium not found")},r.submit.fn.send=function(e){var t=this,n=t.getHierarchialPartString(),o=t.getParamsHash(),u;Titanium&&Titanium.Network?(u=Titanium.Network.createHTTPClient(),u.onload=function(){i(JSON.parse(this.responseText),e)},u.onerror=function(t){r.warn("ERROR!",t.error),s(t.error,e)},u.open("POST",n),u.send(o)):r.warn("Titanium not found.")},r}),t.config({paths:{jquery:"lib/jquery.min",underscore:"lib/lodash.min"}}),t(["api/api","api/submit","api/send-ti"],function(e,t,r){var i=this;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=e),exports.bvapi=e):(i.BV=i.BV||{},i.BV.api=e||{}),typeof n=="function"&&n.amd&&n("bvapi",[],function(){return e})}),n("main",function(){})})()


